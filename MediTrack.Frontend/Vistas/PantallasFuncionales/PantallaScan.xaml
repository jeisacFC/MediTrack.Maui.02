<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:zxing="clr-namespace:ZXing.Net.Maui.Controls;assembly=ZXing.Net.MAUI.Controls"
             xmlns:viewModels="clr-namespace:MediTrack.Frontend.ViewModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="MediTrack.Frontend.Vistas.PantallasFuncionales.PantallaScan"
             Title="Escanear código" NavigationPage.HasNavigationBar="False">
    
    <!--<ContentPage.BindingContext>
        <viewModels:ScanViewModel />
    </ContentPage.BindingContext>-->

    <Grid>
        <zxing:CameraBarcodeReaderView
            x:Name="barcodeView"
            IsDetecting="{Binding IsDetecting, Mode=TwoWay}"
            Options="{Binding BarcodeReaderOptions}"
            HorizontalOptions="FillAndExpand"
            VerticalOptions="FillAndExpand">
            <zxing:CameraBarcodeReaderView.Behaviors>
                <toolkit:EventToCommandBehavior
                    EventName="BarcodesDetected"
                    Command="{Binding ProcesarCodigosDetectadosCommand}" />
            </zxing:CameraBarcodeReaderView.Behaviors>
        </zxing:CameraBarcodeReaderView>

        <Grid RowDefinitions="Auto,*,Auto" ColumnDefinitions="*">

            <Border Grid.Row="0" StrokeThickness="0" BackgroundColor="#AA3B71FF">
                <StackLayout Padding="15,30,15,15">
                    <Grid ColumnDefinitions="Auto,*,Auto">
                        <Button Grid.Column="0" Text="Cancelar" Clicked="Cancelar_Clicked_Header" TextColor="White" BackgroundColor="Transparent" HorizontalOptions="Start"/>
                        <Label Grid.Column="1" Text="Escanear código" TextColor="White" FontSize="Title" FontAttributes="Bold" HorizontalTextAlignment="Center" VerticalTextAlignment="Center"/>
                    </Grid>
                    <Label Text="Alinea el código de barras para identificar tu medicamento"
                           TextColor="White" Opacity="0.8" FontSize="Small" HorizontalTextAlignment="Center" Margin="0,5,0,0"/>
                </StackLayout>
            </Border>

            <Border Grid.Row="1"
                    Stroke="White" StrokeThickness="3" CornerRadius="10"
                    WidthRequest="280" HeightRequest="180"
                    HorizontalOptions="Center" VerticalOptions="Center"
                    Opacity="0.7"/>

            <Border Grid.Row="2" StrokeThickness="0" BackgroundColor="#AA3B71FF">
                <StackLayout Padding="15,15,15,20">
                    <Button Text="Buscar medicamento de manera manual"
                            Command="{Binding BuscarManualCommand}" TextColor="White"
                            FontSize="Body"
                            BackgroundColor="Transparent"
                            HorizontalOptions="Center"/>
                </StackLayout>
            </Border>
        </Grid>
    </Grid>
</ContentPage>