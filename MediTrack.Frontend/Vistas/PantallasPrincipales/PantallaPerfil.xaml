<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="MediTrack.Frontend.Vistas.PantallasPrincipales.PantallaPerfil"
    BackgroundColor="#e6f0ff"
    Title="Perfil">

    <Grid>

        <!-- 1) Encabezado azul con patrón -->
        <Grid HeightRequest="150"
          VerticalOptions="Start">
            <BoxView Color="#3b71ff"
               Opacity="0.9"
               HorizontalOptions="Fill"
               VerticalOptions="Fill" />
            <Image Source="logo_patron.png"
             Aspect="AspectFill"
             Opacity="0.15"
             HorizontalOptions="Fill"
             VerticalOptions="Fill" />
        </Grid>

        <!-- 2) Contenedor blanco desplazable, sin avatar -->
        <ScrollView Margin="0,80,0,0">
            <Frame CornerRadius="40"
             Margin="0"
             Padding="25,80,25,25"
             BackgroundColor="White"
             HasShadow="False">

                <VerticalStackLayout Spacing="25">
                    <!-- Información Personal -->
                    <Label Text="Información Personal"
                 FontAttributes="Bold"
                 FontSize="16"
                 TextColor="#0B2B6E" />

                    <Grid ColumnDefinitions="Auto,*"
                RowDefinitions="Auto,Auto,Auto,Auto"
                ColumnSpacing="10"
                RowSpacing="10">
                        <Label Text="Nombre" Grid.Row="0" Grid.Column="0" TextColor="#0B2B6E"/>
                        <Label Text="Jeremy" Grid.Row="0" Grid.Column="1"/>
                        <Label Text="Apellidos" Grid.Row="1" Grid.Column="0" TextColor="#0B2B6E"/>
                        <Label Text="Duran Vargas" Grid.Row="1" Grid.Column="1"/>
                        <Label Text="Fecha de nacimiento" Grid.Row="2" Grid.Column="0" TextColor="#0B2B6E"/>
                        <Label Text="02/11/2003" Grid.Row="2" Grid.Column="1"/>
                        <Label Text="Género" Grid.Row="3" Grid.Column="0" TextColor="#0B2B6E"/>
                        <Label Text="Masculino" Grid.Row="3" Grid.Column="1"/>
                    </Grid>

                    <!-- Información de Contacto -->
                    <Label Text="Información de Contacto"
                 FontAttributes="Bold"
                 FontSize="16"
                 TextColor="#0B2B6E" />
                    <Grid ColumnDefinitions="Auto,*"
                RowDefinitions="Auto,Auto"
                ColumnSpacing="10"
                RowSpacing="10">
                        <Label Text="Celular" Grid.Row="0" Grid.Column="0" TextColor="#0B2B6E"/>
                        <Label Text="72386291" Grid.Row="0" Grid.Column="1"/>
                        <Label Text="Correo Electrónico" Grid.Row="1" Grid.Column="0" TextColor="#0B2B6E"/>
                        <Label Text="jeremy@meditrack.com" Grid.Row="1" Grid.Column="1"/>
                    </Grid>

                    <!-- Información Médica -->
                    <Label Text="Información Médica"
                 FontAttributes="Bold"
                 FontSize="16"
                 TextColor="#0B2B6E" />

                    <!-- Colección de Padecimientos -->
                    <Label Text="Padecimientos" TextColor="#0B2B6E" />
                    <CollectionView ItemsSource="{Binding Padecimientos}"
                          SelectionMode="Multiple"
                          SelectionChanged="OnPadecimientosSeleccionados">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="10">
                                    <Label Text="{Binding Nombre}"
                         FontSize="14"
                         TextColor="Black" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <!-- Colección de Alergias -->
                    <Label Text="Alergias" TextColor="#0B2B6E" />
                    <CollectionView ItemsSource="{Binding Alergias}"
                          SelectionMode="Multiple"
                          SelectionChanged="OnAlergiasSeleccionadas">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="10">
                                    <Label Text="{Binding Nombre}"
                         FontSize="14"
                         TextColor="Black" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <!-- Botón Cerrar sesión -->
                    <Button Text="Cerrar sesión"
                  BackgroundColor="White"
                  TextColor="#3b71ff"
                  BorderColor="#3b71ff"
                  BorderWidth="2"
                  CornerRadius="20"
                  HeightRequest="45"
                  WidthRequest="250"
                  HorizontalOptions="Center"
                  Clicked="OnCerrarSesionClicked"/>
                </VerticalStackLayout>
            </Frame>
        </ScrollView>

        <!-- 3) Avatar para la foto de perfil -->
        <Grid HorizontalOptions="Center"
          VerticalOptions="Start"
          Margin="0,30,0,0">
            <Frame BackgroundColor="White"
             CornerRadius="60"
             HeightRequest="120"
             WidthRequest="120"
             Padding="15"
             HasShadow="True">
                <Label FontFamily="MaterialIcons"
               Text="&#xE853;"
               FontSize="90"
               TextColor="#3b71ff"
               HorizontalOptions="Center"
               VerticalOptions="Center"/>
            </Frame>
            <Frame Padding="0"
             WidthRequest="28"
             HeightRequest="28"
             BackgroundColor="White"
             CornerRadius="14"
             HorizontalOptions="Center"
             VerticalOptions="Start"
             Margin="0,-10,0,0"
             HasShadow="True">
                <Label FontFamily="MaterialIcons"
               Text=""
               FontSize="20"
               TextColor="#3b71ff"
               HorizontalOptions="Center"
               VerticalOptions="Center"/>
            </Frame>
        </Grid>

    </Grid>
</ContentPage>
